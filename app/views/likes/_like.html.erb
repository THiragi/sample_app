<% if micropost.like_user(current_user.id) %>
  <% path = micropost_like_path(likes, micropost_id: micropost.id) %>
  <% method = :delete %>
  <% cls = "btn btn-xs btn-success" %>
<% else %>
  <% path = micropost_likes_path(micropost) %>
  <% method = :post %>
  <% cls = "btn btn-xs btn-default" %>
<% end %>

<%= button_to path, method: method, class: cls, remote: true do %> 
  <%= content_tag(:span, "Like") %>
    <%= micropost.likes.count %>
<% end %>